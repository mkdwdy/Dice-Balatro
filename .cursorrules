# Cursor 개발 규칙

## 필수 원칙: 브라우저 직접 테스트

**모든 개발이나 버그 수정 후에는 반드시 브라우저에서 직접 해당 동작을 테스트하여 제대로 동작하는지 확인해야 합니다.**

자세한 내용은 `docs/DEVELOPMENT_PRINCIPLES.md`를 참조하세요.

---

## 개발 워크플로우

1. 코드 수정/개발 완료
2. **브라우저에서 직접 테스트 (필수 - 절대 생략 불가)**
   - 게임 시작 → 스테이지 선택 → 게임 플레이
   - 수정된 기능/버그 수정 사항 직접 확인
   - 예상대로 동작하는지 검증
3. 문제 발견 시 즉시 수정 후 재테스트
4. 정상 동작 확인 후 완료
5. **테스트 결과 사용자에게 보고**

---

## 테스트 강제화 규칙

**⚠️ 절대 무시 금지**: 다음 규칙을 위반하면 심각한 버그가 프로덕션에 배포될 수 있습니다.

### 필수 테스트 프로세스 (순서대로 진행)

1. **코드 수정 완료**
2. **서버 코드 수정 시 → 서버 재시작 확인** (`npm run dev`)
3. **브라우저에서 직접 테스트** (게임 시작 → 기능 확인)
4. **테스트 결과 확인** (예상 결과와 실제 결과 비교)
5. **문제 발견 시 → 수정 → 2번부터 재시작**
6. **모든 테스트 통과 확인**
7. **테스트 결과 사용자에게 보고**

### 절대 생략 불가

- 모든 코드 수정 후 **즉시** 브라우저 테스트 수행
- 서버 코드 수정 시 **반드시** 서버 재시작 확인 (`npm run dev`)
- 서버가 정상 실행 중인지 확인 (포트 5000, 로그 확인)
- 테스트 도구(TEST 버튼)를 활용하여 빠르게 테스트
- 테스트를 생략하고 "완료"라고 보고하지 않기
- 테스트 결과를 확인하지 않고 보고하지 않기
- 문제 발견 시 수정 후 **반드시 재테스트**
- 테스트 결과를 사용자에게 명확히 보고 (테스트 방법, 결과 포함)
- **"코드 수정 완료" ≠ "작업 완료"** - 테스트가 성공해야만 완료

### 테스트 완료 기준 (모두 충족해야 함)

- ✅ 서버가 정상 실행 중 (서버 코드 수정 시)
- ✅ 브라우저에서 게임이 정상 시작됨
- ✅ 수정된 기능이 예상대로 동작함
- ✅ 관련 기능에 부작용이 없음
- ✅ 오류가 발생하지 않음 (브라우저 콘솔, 서버 로그)
- ✅ 예상 결과와 실제 결과가 일치함
- ✅ 테스트 방법과 결과를 사용자에게 보고함

### 테스트 완료 기준

다음이 모두 확인되어야 테스트 완료:
- ✅ 서버가 정상 실행 중 (서버 코드 수정 시)
- ✅ 브라우저에서 게임이 정상 시작됨
- ✅ 수정된 기능이 예상대로 동작함
- ✅ 관련 기능에 부작용이 없음
- ✅ 오류가 발생하지 않음
- ✅ 예상 결과와 실제 결과가 일치함

**이 원칙은 절대 변경되지 않으며 항상 준수해야 합니다.**

---

## ⚠️ 테스트 생략 방지 메커니즘

### 작업 완료 보고 전 필수 확인

**다음이 모두 확인되어야만 "작업 완료"라고 보고합니다:**

1. ✅ 코드 수정 완료
2. ✅ 서버 재시작 확인 (서버 코드 수정 시)
3. ✅ 브라우저에서 직접 테스트 완료
4. ✅ 테스트 결과 확인 완료 (예상 결과와 실제 결과 일치)
5. ✅ 테스트 방법과 결과를 사용자에게 보고

**위 항목 중 하나라도 누락되면 "작업 완료"라고 보고하지 않습니다.**

### 테스트 생략 시 대응

- 테스트를 생략하고 "완료"라고 보고하면 → 즉시 테스트 수행 후 재보고
- 테스트 결과를 확인하지 않고 보고하면 → 즉시 확인 후 재보고
- 문제 발견 시 수정 후 재테스트하지 않으면 → 즉시 재테스트 후 재보고

**이 메커니즘은 절대 변경되지 않으며 항상 준수해야 합니다.**

---

## 🚨 작업 완료 보고 전 필수 체크리스트

**⚠️ 절대 생략 불가**: 다음 체크리스트를 모두 확인한 후에만 "작업 완료"라고 보고합니다.

### 코드 수정 후 즉시 확인 (순서대로)

- [ ] **1단계: 코드 수정 완료 확인**
  - [ ] 코드 작성/수정이 완료되었는가?
  - [ ] 문법 오류가 없는가?
  - [ ] 린터 오류가 없는가?

- [ ] **2단계: 서버 재시작 확인 (서버 코드 수정 시)**
  - [ ] 서버 코드를 수정했는가?
  - [ ] 서버를 재시작했는가? (`npm run dev`)
  - [ ] 서버가 정상 실행 중인가? (포트 5000 확인)
  - [ ] 서버 로그에 오류가 없는가?

- [ ] **3단계: 브라우저 테스트 실행**
  - [ ] 브라우저에서 `http://localhost:5000` 접속했는가?
  - [ ] 게임을 시작했는가?
  - [ ] 수정된 기능을 직접 사용해봤는가?
  - [ ] 예상대로 동작하는가?
  - [ ] 테스트 도구(TEST 버튼)를 사용했는가?

- [ ] **4단계: 테스트 결과 확인**
  - [ ] 예상 결과와 실제 결과가 일치하는가?
  - [ ] 브라우저 콘솔에 오류가 없는가? (F12 확인)
  - [ ] 서버 로그에 오류가 없는가?
  - [ ] 관련 기능에 부작용이 없는가?

- [ ] **5단계: 테스트 결과 보고**
  - [ ] 테스트 방법을 명시했는가?
  - [ ] 테스트 결과를 명시했는가?
  - [ ] 예상 결과와 실제 결과를 비교했는가?
  - [ ] 문제가 발견되었는가? (발견 시 수정 후 재테스트)

**위 체크리스트를 모두 통과하지 않으면 절대 "작업 완료"라고 보고하지 않습니다.**

### "완료" 보고 금지 조건

다음 중 하나라도 해당되면 "완료"라고 보고하지 않습니다:
- ❌ 테스트를 수행하지 않았을 때
- ❌ 테스트 결과를 확인하지 않았을 때
- ❌ 서버 재시작이 필요한데 재시작하지 않았을 때
- ❌ 테스트 방법과 결과를 보고하지 않았을 때
- ❌ 문제가 발견되었는데 수정 후 재테스트하지 않았을 때

### 올바른 완료 보고 형식

```
## ✅ 작업 완료

### 수정 내용
- [수정한 내용 설명]

### 테스트 방법
- [테스트 방법 설명]
  - 서버 재시작: ✅ 완료 (서버 코드 수정 시)
  - 브라우저 접속: ✅ http://localhost:5000
  - 테스트 시나리오: [구체적인 테스트 시나리오]

### 테스트 결과
- 예상 결과: [예상 결과]
- 실제 결과: [실제 결과]
- 일치 여부: ✅ 일치 / ❌ 불일치 (수정 후 재테스트 완료)

### 확인 사항
- ✅ 서버 정상 실행 중
- ✅ 브라우저에서 게임 정상 시작
- ✅ 수정된 기능 정상 동작
- ✅ 관련 기능 부작용 없음
- ✅ 오류 없음 (브라우저 콘솔, 서버 로그)
```

---

## 🌐 인터넷 연결 문제 대응 규칙

**⚠️ 중요**: 인터넷 연결 문제가 발생해도 작업을 계속할 수 있어야 합니다.

### 웹 검색 사용 원칙

**우선순위 (순서대로):**
1. **코드베이스 검색 우선** (`codebase_search`)
   - 로컬 코드베이스에서 먼저 검색
   - 기존 문서 확인 (`docs/` 폴더)
   - 코드 내 검색 (`grep`)

2. **파일 읽기** (`read_file`)
   - 관련 파일 직접 읽기
   - 문서 파일 확인

3. **웹 검색은 최후의 수단** (`web_search`)
   - 로컬에서 찾을 수 없을 때만 사용
   - 간단한 검색어 사용
   - 결과를 문서로 저장하여 재사용

### 네트워크 문제 발생 시 대응

**즉시 실행:**
1. **재시도** (최대 3회, 5초 간격)
2. **실패 시 대안 방법 시도**
   - 웹 검색 실패 → 코드베이스 검색으로 대체
   - npm 설치 실패 → 기존 패키지 사용
   - 외부 API 실패 → 로컬 모킹
3. **문제 기록** (`docs/NETWORK_ISSUES_LOG.md`)
4. **사용자에게 상황 보고**

### 작업 전환 시 네트워크 확인

**작업 시작 전:**
- [ ] 기본 인터넷 연결 확인 (ping 테스트)
- [ ] Git 상태 확인 (`git status`)
- [ ] 수정된 파일 확인 (`git diff --stat`)
- [ ] 이전 작업 문서 확인

**네트�워크 문제 발생 시:**
- [ ] 오프라인 작업 가능한지 확인
- [ ] 로컬 코드베이스 검색으로 대체
- [ ] 문제 기록 및 사용자에게 보고

### 작업 상태 자동 저장

**원칙:**
- 작업 시작 시 Git 상태 확인
- 주기적 상태 저장 (중요한 변경사항마다)
- 작업 전환 전 상태 확인

**실행:**
```bash
# 작업 시작 전
git status
git diff --stat

# 작업 중 (중요한 변경사항마다)
git add .
git commit -m "WIP: 작업 진행 중"

# 작업 전환 전
git status
git diff
```

**자세한 내용은 `docs/INTERNET_CONNECTION_ISSUES.md`를 참조하세요.**

